"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="35e9816e-7b4f-53f3-9416-8230695d0e76")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[4421],{741477:(e,t,i)=>{i.d(t,{E:()=>a});var n=i(302245);let r=(0,n.Mz)(e=>e.dropdownShown,e=>e?.type),a=e=>(0,n.Mz)(r,t=>t===e)},395116:(e,t,i)=>{i.d(t,{Dd:()=>k,X2:()=>T,Zo:()=>R,gG:()=>C,gN:()=>h,hI:()=>N,i3:()=>b,td:()=>I});var n=i(188507),r=i(138020),a=i(38580);if(443==i.j)var o=i(374626);var l=i(790724),c=i(286640),s=i(27087),_=i(939863),u=i(980820),d=i(725561),E=i(140908),m=i(860178),f=i(279453);let p="user-notifications-sticky-filter-tab";function h(e,t){return e.length>t?e.slice(0,t-3)+"...":e}let R=(0,u.nF)((e,t)=>{if(!t.userInitiated){e.dispatch(d.uR(t));return}let i="0"==t.notificationSpaceId?null:t.notificationSpaceId,n={bell:t.isBellStateHigh,current_org_id:i};return(0,l.Q)({requestPromise:s.Ay.put("/api/user_notifications_bell",n),fallbackError:(0,_.t)("user_notification.an_error_occurred_marking_all_as_read"),store:e,next:e.dispatch,action:d.uR(t)})}),T=(0,u.nF)((e,t)=>{if(!t.userInitiated){e.dispatch(d.Q$(t));return}return(0,l.Q)({requestPromise:s.Ay.put("/api/user_notifications_bell/community/clear"),fallbackError:(0,_.t)("user_notification.an_error_occurred_marking_all_as_read"),store:e,next:e.dispatch,action:d.Q$(t)})});function k(){return c.x4?.getItem(p)||"all"}function N(e){return c.x4?.setItem(p,e)}let I="-1",w={isHigh:!1,fileKeyWithoutBadge:null},C=(0,a.eU)(e=>e((0,f.UC1)({})).transform(e=>{if(e.allPlanNotificationBellState.status!==r.tT.Loaded||!e.allPlanNotificationBellState.data)return w;let t=e.allPlanNotificationBellState.data;return{isHigh:t.bell,fileKeyWithoutBadge:t?.fileKeyWithoutBadge}}).unwrapOr(w));function b(){let e=(0,m.iZ)(),t=(0,E.Ut)(),i=(0,n.d4)(e=>e.userNotifications),r=(0,o.md)(C);return!!e&&(t?r.isHigh:i&&!!i.userBellStates?.[e.id]?.[I])}},899422:(e,t,i)=>{i.d(t,{d:()=>H});var n=i(411855),r=i(188507),a=i(755020),o=i(139689),l=i(841368),c=i(682301),s=i(776250),_=i(915440),u=i(860601),d=i(743282),E=i(493323),m=i(355819),f=i(204930),p=i(939863),h=i(278733),R=i(975350),T=i(103907),k=i(696097),N=i(259927),I=i(654034),w=i(920037),C=i(860178),b=i(279453),A=i(531827),g=i(440535),y=i(91425),v=i(238559),D=i(113292),O=i(728268),P=i(636662),S=i(452794),U=i(448879),M=i(884857);let B="quick_reply_thread_view--headerButton--wmkPJ",L=new class{get file(){throw Error("Data should not be accessed directly from quick replies, we need to create standard API for comments to use this view. see: file_comments_api.tsx")}get fileFollower(){throw Error("Data should not be accessed directly from quick replies, we need to create standard API for comments to use this view. see: file_comments_api.tsx")}get comments(){throw Error("Data should not be accessed directly from quick replies, we need to create standard API for comments to use this view. see: file_comments_api.tsx")}},F=null,H=(0,n.forwardRef)((e,t)=>{let i=(0,_.Rs)(b.Uhm,{fileKey:e.quickReplyInfo.fileKey,rootId:e.quickReplyInfo.threadId});return n.createElement("div",{className:"quick_reply_thread_view--container--WPlnN",ref:t},n.createElement("div",{className:"quick_reply_thread_view--column--UrAD4"},n.createElement("div",{className:"quick_reply_thread_view--header--BHlje"},n.createElement("div",{className:B},!e.fileBrowser&&n.createElement(f.J,{"aria-label":(0,p.t)("quick_reply.navigate_back"),onClick:e.onClose},n.createElement(a.C,null))),n.createElement("div",{className:"quick_reply_thread_view--fileName--S2twU"},"loaded"===i.status&&i.data.file&&i.data.file.name),n.createElement("div",{className:B},e.fileBrowser?n.createElement(f.J,{"aria-label":(0,p.t)("quick_reply.close"),onClick:e.onClose},n.createElement(o.A,null)):n.createElement("div",{style:{display:"none"}},n.createElement(f.J,{"aria-label":(0,p.t)("quick_reply.more")},n.createElement(l.J,null))))),n.createElement(Q,{quickReplyInfo:e.quickReplyInfo,result:i,hideOverflowMenu:e.fileBrowser})))});function Q(e){let t=(0,C.iZ)();return t?"loading"===e.result.status||"disabled"===e.result.status?n.createElement(E.qc,{size:"medium"}):"errors"===e.result.status||null==e.result.data.file?n.createElement("div",{className:"quick_reply_thread_view--errorState--Re4UD"},(0,p.t)("quick_reply.unable_to_load_thread")):n.createElement(V,{quickReplyInfo:e.quickReplyInfo,result:e.result,user:t,hideOverflowMenu:e.hideOverflowMenu}):null}function V(e){let{quickReplyInfo:t,result:i,user:a}=e,{fileKey:o,threadId:l}=t,_=(0,k.dr)({args:{fileKey:o,rootId:l},subscription:i}),u=(0,r.wA)(),{file:d}=i.data,E=(0,n.useMemo)(()=>(0,A.mp)({currentOrgId:d.org?.id,teamId:d.team?.id,fileKey:o,isOrgGuest:d.org?.currentOrgUser?.permission==="guest",users:[]}),[d.org?.id,d.team?.id,o,d.org?.currentOrgUser?.permission]),{mobileCommentThread:m}=d,{currentUserCommentReadStatus:h}=d,N=m.find(e=>e.id===l),C=m.reduce((e,t)=>t.createdAt.getTime()>e.createdAt.getTime()?t:e).thumbnailUrl,b=(0,r.d4)(e=>e.comments.savingCommentUuids),y=(0,r.d4)(e=>e.comments.lgPendingUuidToServerIdMap);if(!N)return n.createElement("div",null,(0,p.t)("quick_reply.unable_to_load_thread"));let v=m.map(e=>(0,I.G9)(a.id,N,e,h??I.gj,b,y,e.attachments)),D={id:N.id,key:o,anchored:!1,canvasPosition:null,selectionAnchorCanvasPosition:null,comments:v,messageMeta:v[0].message_meta,page:N.clientMeta?.pageId||null,isActive:!0,replyCount:m.length-1,isCanvasMention:!1,pageName:N.clientMeta?.pageId||null,sidebarItemType:g.kT.COMMENT_THREAD},O={api:_,status:i.status,data:L,threads:{status:i.status,data:[D],errors:i.errors},errors:i.errors,isResolvedLoaded:!0,isUnresolvedLoaded:!0};return n.createElement(T.j9.Provider,{value:O},n.createElement("div",{className:"quick_reply_thread_view--mouseContainer--qyIpH",onMouseEnter:()=>{let e=v.some(e=>e.isUnread);F=setTimeout(()=>{_.commentReceipts&&e&&(u(R.AY({receiptsAPI:_.commentReceipts,thread:D})),(0,s.sx)("Comment Thread Read",{commentThreadId:l,threadType:"file_browser_quick_reply"}))},1e3)},onMouseLeave:()=>{F&&clearTimeout(F)}},n.createElement("div",{className:"quick_reply_thread_view--preview--I47Ds"},n.createElement("img",{src:C||void 0,className:"quick_reply_thread_view--previewImage--gSK-n",style:{backgroundColor:(0,w.C)(d.checkpointClientMeta)},alt:"thumbnail"}),n.createElement("div",{className:"quick_reply_thread_view--openFileButton--RBtVz"},n.createElement(f.J,{"aria-label":(0,p.t)("quick_reply.open_file"),onClick:()=>{let e=t.deeplink??`/file/${o}?fuid=${a.id}&#${l}`;window.location.href=e}},n.createElement(c.V,null)))),n.createElement(x,{loadedComments:v,user:a,quickReplyInfo:t,commentMentionables:E,hideOverflowMenu:e.hideOverflowMenu})))}function q(){let e=(0,r.wA)(),t=(0,r.d4)(e=>e.dropdownShown||null),i=(0,C.iZ)(),a=(0,y.v)();if(!t||t.type!==N.VJ)return null;let{comment:o,parentRect:l,thread:c,isUnread:s}=t.data;return n.createElement(O.V,{dispatch:e,comment:o,parentRect:l,currentUser:i,isUnread:s,thread:c,copyLink:a})}function x(e){let{loadedComments:t,user:i,quickReplyInfo:a,commentMentionables:o,hideOverflowMenu:l}=e,{fileKey:c,threadId:s}=a,_=(0,r.wA)();(0,n.useEffect)(()=>{_(R.Fm({threadId:s}))},[_,s]);let E=(0,r.d4)(e=>e.comments.typeahead),f=(0,r.d4)(e=>e.comments.editingComment),k=(0,r.d4)(e=>e.dropdownShown||null),N=(0,r.d4)(e=>e.comments.activeThread?.id),I=(0,r.d4)(e=>e.comments.threads),w=N&&I[N]||null,C=w?.reply.messageMeta||[],{submitReply:b,updateMessage:A,submitEdit:y}=function(e){let t=(0,r.wA)(),i=(0,T.I_)().writeAPI,a=T._9()?.threads;return{submitReply:n.useCallback(e=>{if(!i){console.error("Calling submitReply with no write API");return}a&&"loaded"===a.status&&a.data.find(t=>t.id===e.threadId)&&(e.onCommentValidationFailure=(n,r,a,o)=>R.dB(i,t,n,r,a,o,e.uuid,U.y),t(R.lV({...e,commentsWriteApi:i,commentsConfiguration:U.y,trackingContext:{feature:"web_quick_reply_screen"}})))},[t,a,i]),updateMessage:n.useCallback(i=>{t(R.k7({threadId:e,messageMeta:i}))},[t,e]),submitEdit:n.useCallback((e,i)=>{t(R._v({comment:e,messageMeta:i}))},[t])}}(s),B=(0,D._B)(),L=n.useRef(null),F=n.useRef(null),H=n.useRef(null),[Q,V]=n.useState(null),[x,G]=n.useState(n.useRef(null)),Y=n.useRef(null),$=0,W=0,K=0;Y.current&&Y.current.offsetParent&&($=Y.current.offsetWidth,W=Y.current.offsetLeft,K=Y.current.offsetParent.clientHeight-Y.current.offsetTop);let j=e=>e||{x:0,y:0},z=n.useRef(null);(0,n.useEffect)(()=>{z.current&&z.current.scrollToBottom()},[]);let J=[...new Set(t.map(e=>e.user.handle))],X=t.find(e=>e.id===s);return X?n.createElement(n.Fragment,null,n.createElement("div",{style:h.sx.flex1.$}),n.createElement(m.P,{className:"quick_reply_thread_view--bottomAnchoredScrollContainer--5-F87",useBottomPinning:!0,ref:z,enableScrollShadow:!0},n.createElement("div",{className:"quick_reply_thread_view--reverseColumn--ur8Yx"},t.slice().reverse().map((e,r)=>n.createElement(O.I,{editorRef:H,key:`thread-comment-${e.id}`,dispatch:_,user:i,thread:{comments:t,key:c,id:s},setHyperlinkLocation:V,hyperlinkLocation:Q,setHyperlinkEditorRef:G,comment:e,typeahead:E,mentionables:o,prevAuthor:0===r?null:t[r-1].user_id,index:r,editingComment:f,submitEdit:y,dropdownShown:k,viewportPositionFromClientPosition:j,editorOnInsert:B.editorOnInsert,editorOnClear:B.editorOnClear,threadPosition:{x:0,y:0},setIsEditorFocused:u.lQ,showEditedIndicator:!!e.edited_at,hideOverflowMenu:l,hideReactions:!1,hideEmojiPicker:!1,allowAttachments:!1,hideResolve:!1,setResolved:u.lQ,mountInputFocused:!0,editorType:"comment-editor-thread",isQuickReplyThreadView:!0})))),n.createElement(P.K,{editorRef:F,dispatch:_,user:i,typeahead:E,mentionables:o,threadPosition:null,messageMeta:C,submitText:(0,p.t)("comments.reply"),placeholderText:(0,p.t)("comments.reply"),setHyperlinkLocation:V,hyperlinkLocation:Q,setHyperlinkEditorRef:G,onCancel:u.lQ,onSubmit:()=>{b({threadId:s,threadUuid:X.uuid||void 0,uuid:(0,d.g)()})},onComposeFocus:void 0,editorOnInsert:B.editorOnClear,editorOnClear:B.editorOnInsert,viewportPositionFromClientPosition:j,isDisabled:!1,mountInputFocused:!0,updateMessage:A,setIsEditorFocused:u.lQ,isEmojiPickerDisabled:null!==f,hideEmojiPicker:!1,allowAttachments:!1,recordingKey:g.Dw.quickReply,className:M.MJ,threadId:s,fileKey:c,editingExistingComment:!1,editorType:"comment-editor-reply",authorNames:J,replyContainerRef:Y}),n.createElement(v.rf,{decoratorsRef:L,onClear:B.onClear,onInsert:B.onInsert,width:$,direction:S.ri.UPWARDS,positionFromBottom:{left:W,bottom:K}}),n.createElement(q,null)):null}},71881:(e,t,i)=>{i.d(t,{g:()=>s});var n=i(411855),r=i(629019),a=i.n(r),o=i(163023),l=i(470504),c=i(783423);let s=n.forwardRef((e,t)=>{let i=l.cx.h16.w16.ml1.flex.justifyCenter.itemsCenter.with({colorIconOnbrand:e.isOnBrandColor,colorIcon:!e.isOnBrandColor}).$;return n.createElement("button",{className:a()("dropdown_button--button--BR3bZ",e.buttonClassName,{"dropdown_button--active--ZkglI":e.isShowingDropdown}),onClick:e.onClick,ref:t,"data-testid":e.dataTestId,"aria-label":e["aria-label"]},e.children,n.createElement(o.B,{svg:c.A,className:i}))})},204930:(e,t,i)=>{i.d(t,{J:()=>a});var n=i(411855),r=i(75395);let a=n.forwardRef(function({children:e,...t},i){return n.createElement(r.E,{...t,ref:i,className:"icon_button_32--iconButton--gFcI9"},n.createElement("span",{"aria-hidden":!0,className:"icon_button_32--icon--8SoTm"},e))})},899028:(e,t,i)=>{i.d(t,{H:()=>a});var n=i(411855),r=i(860601);let a=n.createContext({shouldShowChevron:e=>!1,onClick:()=>!1,onMouseEnter:r.lQ,onMouseMove:r.lQ,onRemove:r.lQ})},134179:(e,t,i)=>{i.d(t,{IP:()=>eW,fd:()=>r,he:()=>e$,ql:()=>eY});var n,r,a=i(411855),o=i(188507),l=i(629019),c=i.n(l),s=i(297666),_=i(517333),u=i(992405),d=i(737947),E=i(179479),m=i(358145),f=i(374626),p=i(27087),h=i(946689),R=i(493323),T=i(355819),k=i(939863),N=i(392592),I=i(738269),w=i(507877),C=i(140908),b=i(988022),A=i(671206),g=i(335682),y=i(694687),v=i(594901),D=i(860178),O=i(707465),P=i(395116),S=i(369351),U=i(612430),M=i(296210),B=i.n(M),L=i(934480),F=i(564577),H=i(163023),Q=i(881388),V=i(178466),q=i(67294),x=i(959232),G=i(928491),Y=i(127391),$=i(899028);let W="block_kit_row--rowTop--4zNja",K="block_kit_row--metadataContainer--tcs33",j="block_kit_row--usersContainer--J5oFI",z="block_kit_row--usersContainerStructuredView--PUPYI",J="block_kit_row--quickReplyChevron--0rKX3",X="block_kit_row--chevronIcon--2uviD",Z="block_kit_row--imagePreview--CqQsi";var ee=i(163119);function et(e){return a.createElement("span",{className:"block_kit_row--htmlTextBlock--wINSP",dangerouslySetInnerHTML:{__html:B().sanitize(e.block.html_text)}})}function ei(e){let t=(0,L.UF)(e.block.emoji_shortcode)[0];return t.meta?a.createElement("span",{className:"block_kit_row--emojiUnicode--qBoed"},t.unicode):a.createElement(a.Fragment,null)}function en(e){return e?e.map((e,t)=>"HtmlTextBlock"===e._block_type?a.createElement(et,{key:t,block:e}):a.createElement(ei,{key:t,block:e})):[]}function er(e){let{block:t,size:i}=e;return a.createElement(G.Ro,{entity:{...t,id:t.entity_id},size:i,hideFallbackInitial:!1,shape:t.shape.toUpperCase()})}function ea(e){let{block:t}=e;return a.createElement("div",{className:`${Z} thumbnail_DEPRECATED--tileThumbnail--4kE7l`,style:{background:`url(${(0,x.A)()})`}},a.createElement("div",{className:"thumbnail_DEPRECATED--thumbnailContainer--xPcsg",style:{backgroundColor:(e=>{if(!e||0===e.alpha)return"transparent";let{red:t,green:i,blue:n,alpha:r}=e;return`rgba(${255*t|0}, ${255*i|0}, ${255*n|0}, ${r})`})(t.background_color)}},a.createElement("div",{className:"thumbnail_DEPRECATED--thumbnail--WuuvA thumbnail_DEPRECATED--baseThumbnail--8p9z4",style:{backgroundImage:`url(${t.img_url})`}})))}function eo(e){let{block:t}=e;return a.createElement("div",{className:"block_kit_row--square--vD5SO"},a.createElement("div",{className:Z,style:{backgroundImage:`url(${t.img_url})`}}))}function el(e){let{avatars:t}=e;return 0===t.length?null:t.length>1?a.createElement("div",{className:j},a.createElement("div",{className:"block_kit_row--secondaryUser--hkjpm"},a.createElement(er,{block:t[1],size:q.Pf.MEDIUM})),a.createElement("div",{className:"block_kit_row--primaryUser--lg4hR"},a.createElement(er,{block:t[0],size:q.Pf.MEDIUM}))):a.createElement("div",{className:j},a.createElement(er,{block:t[0],size:q.Pf.LARGE}))}function ec(e){let{avatars:t,icon:i}=e;return 0===t.length?null:t.length>1?a.createElement("div",{className:z},a.createElement("div",{className:"block_kit_row--secondaryUserRevamp--ZkcO7"},a.createElement(er,{block:t[1],size:q.Pf.MEDIUM})),a.createElement("div",{className:"block_kit_row--primaryUserRevamp--XYq-9"},a.createElement(er,{block:t[0],size:q.Pf.MEDIUM})),i&&a.createElement(es,{icon:i})):a.createElement("div",{className:z},a.createElement(er,{block:t[0],size:q.Pf.LARGE}),i&&a.createElement(es,{icon:i}))}function es(e){let{icon:t}=e,i=new Set(["https://static.figma.com/uploads/fc8b3d0c889b51bd8800945089e8b473ff4d619d"]);return a.createElement("div",{className:"block_kit_row--icon--YApgQ"},"ImageThumbnailBlock"===t._block_type?a.createElement("img",{className:`block_kit_row--iconImg--SRdFH ${i.has(t.img_url)?"":"block_kit_row--iconInvert--7YBRA"} `,src:t.img_url,alt:""}):a.createElement(ei,{block:t}))}function e_(e){let t=(0,o.wA)(),{block:i,callbacks:n,isPrimary:r=!0}=e,l=async()=>{let e=n.buildNotificationActionRequest(i.notification_action);await e.then(({data:e})=>{if(i.hide_after_action)n.hideNotification();else if(n.followLinkIfPossible(),e.meta.updated_notification_blob){let t=e.meta.updated_notification_blob;n.updateNotification(t.notification_id,t)}},()=>{let e="resolve"===i.notification_action?(0,k.t)("user_notification.an_error_occurred_while_clicking_this_notification"):(0,k.t)("user_notification.an_error_occurred_while_removing_this_notification");t(Q.s.error(e))})},c=en([i.text]);return r?a.createElement(h.$$,{className:"block_kit_row--acceptButton--1Fa1c",onClick:l},c):a.createElement(h.nR,{className:"block_kit_row--rejectButton--Hu8KY",onClick:l},c)}function eu(e){let{block:t,actionBlockCallbacks:i}=e;return a.createElement("div",{className:"block_kit_row--rowBottom--dKrKA"},a.createElement(e_,{block:t.secondary_action,callbacks:i,isPrimary:!1}),a.createElement(e_,{block:t.primary_action,callbacks:i,isPrimary:!0}))}function ed(e){let{block:t,plan:i,shouldShowChevron:n,userLastViewedTimestamp:r}=e;switch(t._block_type){case"BodyAndThumbnailBlock":return a.createElement(eE,{block:t,plan:i,shouldShowChevron:n});case"SplitlineTitleAndBodyBlock":return a.createElement(em,{block:t,shouldShowChevron:n,userLastViewedTimestamp:r})}}function eE(e){let{block:t,plan:i,shouldShowChevron:n}=e;return a.createElement(a.Fragment,null,a.createElement("div",{className:"block_kit_row--contentContainer--ZbpO2 text--fontPos11--2LvXf text--_fontBase--QdLsd"},a.createElement("div",{className:"block_kit_row--content--52-rY"},a.createElement("div",null,en(t.title)),a.createElement("div",{className:K},a.createElement("div",{className:"block_kit_row--textContainer--168xh"},t.description&&a.createElement("div",{className:"block_kit_row--notificationDescription--lMjfr ellipsis--ellipsisAfter3Lines--h405C ellipsis--_ellipsisAfterNLines--LzI7k"},en(t.description)),a.createElement("div",{className:"block_kit_row--fromNow--ryp9b"},i&&a.createElement(a.Fragment,null,a.createElement(Y.H,{entityId:i.id.toString(),entityName:i.name,imgUrl:i.img_url||void 0}),(0,P.gN)(i.name,21),a.createElement("div",{className:"block_kit_row--planDivider--XnNq8"},"\xb7")),a.createElement(F.h1,{date:t.created_at,style:"short"}))),n&&a.createElement("div",{className:J},a.createElement(H.B,{svg:ee.A,className:X}))))),(()=>{if(!t.thumbnail)return null;let e=t.thumbnail;switch(e._block_type){case"AvatarBlock":return a.createElement(er,{block:e,size:q.Pf.XLARGE});case"ImageThumbnailBlock":return a.createElement(eo,{block:e});case"FileThumbnailBlock":return a.createElement(ea,{block:e})}})())}function em(e){let{block:t,shouldShowChevron:i,userLastViewedTimestamp:n}=e;return a.createElement("div",{className:"block_kit_row--contentContainerRevamp--voNSM text--fontPos11--2LvXf text--_fontBase--QdLsd"},a.createElement("div",{className:"block_kit_row--titleAndTimestamp--30RnS"},a.createElement("div",{className:"block_kit_row--title--gqwu-"},en(t.title)),a.createElement(ek,{createdAt:t.created_at,lastSeenTimestamp:n})),a.createElement("div",{className:K},a.createElement("div",{className:"block_kit_row--subtitle--jIRsg"},en(t.subtitle)),t.description&&a.createElement("div",{className:"block_kit_row--notificationDescriptionStructuredView--yUeTV ellipsis--ellipsisAfter3Lines--h405C ellipsis--_ellipsisAfterNLines--LzI7k"},en(t.description)),i&&a.createElement("div",{className:"block_kit_row--quickReplyChevronContainer--yONp2"},a.createElement("div",{className:J},a.createElement(H.B,{svg:ee.A,className:X})))))}function ef(e){let{notification:t}=e;return(0,C.ro)()?a.createElement(ep,{notification:t,children:e.children}):a.createElement("div",{className:W},t.is_unread?a.createElement("div",{className:"block_kit_row--unreadDot--e-8EJ"}):null,a.createElement(el,{avatars:t.avatars}),e.children)}function ep(e){let{notification:t}=e;return a.createElement("div",{className:W},t.is_unread?a.createElement("div",{className:"block_kit_row--unreadDotStructuredView--WluAp"}):null,a.createElement(ec,{avatars:t.avatars,icon:t.icon}),e.children)}function eh(e){let{attachment:t,notification:i,dontShowPlanIcon:n}=e;return a.createElement(ef,{notification:i},a.createElement(ed,{block:t.body,plan:!0===n?void 0:i.plan,userLastViewedTimestamp:i.filters.user_last_viewed_timestamp}))}function eR(e){let{attachment:t,notification:i,dontShowPlanIcon:n}=e,{shouldShowChevron:r}=a.useContext($.H);return a.createElement(ef,{notification:i},a.createElement(ed,{block:t.body,plan:!0===n?void 0:i.plan,shouldShowChevron:r(i),userLastViewedTimestamp:i.filters.user_last_viewed_timestamp}))}function eT(e){let{attachment:t,notification:i,actionBlockCallbacks:n}=e;return a.createElement(a.Fragment,null,a.createElement(ef,{notification:i},a.createElement(ed,{block:t.body,plan:i.plan,userLastViewedTimestamp:i.filters.user_last_viewed_timestamp})),a.createElement(eu,{block:t.actions,actionBlockCallbacks:n}))}function ek(e){let{createdAt:t,lastSeenTimestamp:i}=e,n=eN(t,i),r=(0,F.Ak)(t,"narrow");if("today"!==n&&"new"!==n){let e=new Date(t),i={};i=!function(e){let t=new Date;return t.setDate(t.getDate()-365),e>=t}(e)?{month:"short",day:"numeric",year:"numeric"}:{month:"short",day:"numeric"},r=new Intl.DateTimeFormat((0,V.Gq)().getPrimaryLocale(!1),i).format(e)}return a.createElement("div",{className:"block_kit_row--timestamp--FiNtf"},r)}function eN(e,t){let i=new Date(e),n=new Date,r=new Date(n);return(r.setDate(n.getDate()-1),t&&new Date(t)<i)?"new":eI(i,n)?"today":eI(i,r)?"yesterday":i>=new Date(n.getFullYear(),n.getMonth(),n.getDate()-7)?"last_week":"older"}function eI(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}var ew=(e=>(e.NEW="new",e.TODAY="today",e.YESTERDAY="yesterday",e.LAST_WEEK="last_week",e.OLDER="older",e))(ew||{});let eC={new:(0,k.tx)("user_notifications.new"),today:(0,k.tx)("user_notifications.today"),yesterday:(0,k.tx)("user_notifications.yesterday"),last_week:(0,k.tx)("user_notifications.last_7_days"),older:(0,k.tx)("user_notifications.older")};function eb(e){return e.preferred_attachments.length>0&&"ActionableAttachment"===e.preferred_attachments[0]._block_type}var eA=(e=>(e.ACTIONABLE="actionable",e.ACTIONED="actioned",e))(eA||{});let eg={actionable:(0,k.tx)("user_notifications.pending"),actioned:(0,k.tx)("user_notifications.done")};var ey=i(776250),ev=(e=>(e[e.TEXT=0]="TEXT",e[e.FILE_COMMENT=1]="FILE_COMMENT",e[e.FILE_COMMENT_REPLY=2]="FILE_COMMENT_REPLY",e[e.INVITE_FILE=3]="INVITE_FILE",e[e.INVITE_FOLDER=4]="INVITE_FOLDER",e[e.INVITE_TEAM=5]="INVITE_TEAM",e[e.AT_MENTION_INVITE=7]="AT_MENTION_INVITE",e[e.AT_MENTION=8]="AT_MENTION",e[e.TEAM_ROLE_REQUEST_APPROVED=9]="TEAM_ROLE_REQUEST_APPROVED",e[e.TEAM_ROLE_REQUEST_DENIED=10]="TEAM_ROLE_REQUEST_DENIED",e[e.TEAM_ROLE_REQUEST_CREATED=11]="TEAM_ROLE_REQUEST_CREATED",e[e.ORG_ACCOUNT_TYPE_REQUEST_CREATED=12]="ORG_ACCOUNT_TYPE_REQUEST_CREATED",e[e.ORG_ACCOUNT_TYPE_REQUEST_APPROVED=13]="ORG_ACCOUNT_TYPE_REQUEST_APPROVED",e[e.ORG_ACCOUNT_TYPE_REQUEST_DENIED=14]="ORG_ACCOUNT_TYPE_REQUEST_DENIED",e[e.HUB_FILE_DUPLICATED=15]="HUB_FILE_DUPLICATED",e[e.HUB_PLUGIN_INSTALLED=16]="HUB_PLUGIN_INSTALLED",e[e.HUB_FILE_LIKED=17]="HUB_FILE_LIKED",e[e.HUB_PLUGIN_LIKED=18]="HUB_PLUGIN_LIKED",e[e.HUB_FILE_REMIXED=19]="HUB_FILE_REMIXED",e[e.FILE_COMMENT_REACTION=20]="FILE_COMMENT_REACTION",e[e.HUB_PROFILE_FOLLOWED=21]="HUB_PROFILE_FOLLOWED",e[e.HUB_RESOURCE_PUBLISHER_ADDED=22]="HUB_RESOURCE_PUBLISHER_ADDED",e[e.HUB_RESOURCE_PUBLISHER_REMOVED=23]="HUB_RESOURCE_PUBLISHER_REMOVED",e[e.HUB_RESOURCE_COMMENT=24]="HUB_RESOURCE_COMMENT",e[e.HUB_RESOURCE_COMMENT_REPLY=25]="HUB_RESOURCE_COMMENT_REPLY",e[e.INVITE_FILE_REPO=26]="INVITE_FILE_REPO",e[e.FILE_ROLE_REQUEST_CREATED=27]="FILE_ROLE_REQUEST_CREATED",e[e.MERGE_REQUEST_REVIEWER_ADDED=28]="MERGE_REQUEST_REVIEWER_ADDED",e[e.MERGE_REQUEST_APPROVED=29]="MERGE_REQUEST_APPROVED",e[e.MERGE_REQUEST_APPROVAL_REVOKED=30]="MERGE_REQUEST_APPROVAL_REVOKED",e[e.BRANCH_MERGED=31]="BRANCH_MERGED",e[e.BRANCH_ARCHIVED=32]="BRANCH_ARCHIVED",e[e.COMMUNITY_MENTION=33]="COMMUNITY_MENTION",e[e.FILE_ROLE_REQUEST_APPROVED=34]="FILE_ROLE_REQUEST_APPROVED",e[e.MERGE_REQUEST_REVIEWER_INVITED_ADDED=35]="MERGE_REQUEST_REVIEWER_INVITED_ADDED",e[e.ORG_JOIN_REQUEST_CREATED=36]="ORG_JOIN_REQUEST_CREATED",e[e.HUB_WIDGET_LIKED=37]="HUB_WIDGET_LIKED",e[e.HUB_WIDGET_INSTALLED=38]="HUB_WIDGET_INSTALLED",e[e.MERGE_REQUEST_CHANGES_REQUESTED=39]="MERGE_REQUEST_CHANGES_REQUESTED",e[e.ORG_JOIN_REQUEST_APPROVED_TO_SHARER=40]="ORG_JOIN_REQUEST_APPROVED_TO_SHARER",e[e.HUB_PLUGIN_USED=41]="HUB_PLUGIN_USED",e[e.HUB_WIDGET_USED=42]="HUB_WIDGET_USED",e[e.PRO_ACCOUNT_TYPE_REQUEST_CREATED=43]="PRO_ACCOUNT_TYPE_REQUEST_CREATED",e[e.PRO_ACCOUNT_TYPE_REQUEST_APPROVED=44]="PRO_ACCOUNT_TYPE_REQUEST_APPROVED",e[e.PRO_ACCOUNT_TYPE_REQUEST_DENIED=45]="PRO_ACCOUNT_TYPE_REQUEST_DENIED",e[e.INVITE_TEAM_REMINDER=46]="INVITE_TEAM_REMINDER",e[e.PLUGIN_PUBLISHER_ADDED=47]="PLUGIN_PUBLISHER_ADDED",e[e.RESOURCE_SOLD=48]="RESOURCE_SOLD",e[e.INVITE_FILE_REMINDER=49]="INVITE_FILE_REMINDER",e[e.BATCHED_FILE_COMMENT=50]="BATCHED_FILE_COMMENT",e[e.FEED_POST_COMMENT=51]="FEED_POST_COMMENT",e[e.FEED_POST_AT_MENTION=52]="FEED_POST_AT_MENTION",e[e.FEED_POST_REACTION=53]="FEED_POST_REACTION",e[e.RESOURCE_PUBLISH=54]="RESOURCE_PUBLISH",e[e.FEED_COMMENT_REACTION=55]="FEED_COMMENT_REACTION",e[e.FEED_POST_DESCRIPTION_AT_MENTION=56]="FEED_POST_DESCRIPTION_AT_MENTION",e[e.BATCHED_FEED_POST=57]="BATCHED_FEED_POST",e[e.BATCHED_FEED_COMMENT_REACTION=58]="BATCHED_FEED_COMMENT_REACTION",e[e.RESOURCE_SUBSCRIPTION_PRICE_INCREASE=60]="RESOURCE_SUBSCRIPTION_PRICE_INCREASE",e[e.FEED_POLL_CLOSE=61]="FEED_POLL_CLOSE",e[e.FILE_ROLE_REQUEST_PENDING_MOVE_TO_PROJECT=63]="FILE_ROLE_REQUEST_PENDING_MOVE_TO_PROJECT",e[e.VR_USER_SHARED_DRAFT=77]="VR_USER_SHARED_DRAFT",e))(ev||{});function eD(e){let t=e.preferred_attachments.find(e=>n.BlockKit.Block.ATTACHMENT_TYPES.has(e._block_type));if(void 0===t)throw Error(`Unable to render attachment. Hiding notification ${e.notification_id}`);return t}function eO(e){let t;let i=(0,o.wA)(),[n,r]=(0,a.useState)(!1),l=(0,o.d4)(e=>e.selectedView.view),{onClick:c,onMouseEnter:s,onMouseMove:_,onRemove:u}=a.useContext($.H),d=(0,C.ro)(),E=e.notification;a.useEffect(()=>()=>{u(E)},[u,E]);try{t=eD(e.notification)}catch(e){return console.error(`Unsupported Notification: ${e}`),null}let m=e=>{e.stopPropagation()},f=()=>{r(!0),e.onHide&&e.onHide()},p=(e,t=l)=>S.sr.updateNotification({notification_id:E.notification_id,notification_action:e,currentView:t});return!n&&a.createElement("div",{className:d?"block_kit_row--rowContainerRevamp--Ak9PI":"block_kit_row--rowContainer--hsQo5",onClick:n=>{(0,ey.sx)("file_browser_notification_clicked",{notification_id:E.notification_id,notification_type:E.notification_type,actionable:"ActionableAttachment"===t._block_type,selectedView:l,plan_filter:e.currentPlanFilter,notification_filter:e.currentNotificationFilter}),m(n);let r=c(E);"ActionableAttachment"!==t._block_type&&p("resolve").then(({data:t})=>{if(r||e.followLinkOnClickCallback(),t.meta.updated_notification_blob){let i=t.meta.updated_notification_blob;e.updateNotificationCallback(i.notification_id,i)}},e=>{i(Q.s.error((0,k.t)("user_notification.an_error_occurred_while_clicking_this_notification")))})},onMouseDown:m,onMouseEnter:t=>{s(t,E,()=>{p("resolve",l+"_quickreply").then(({data:t})=>{if(t.meta.updated_notification_blob){let i=t.meta.updated_notification_blob;e.updateNotificationCallback(i.notification_id,i)}})})},onMouseMove:e=>{_(e)},"data-testid":"notification-row"},((t,i)=>{try{switch(t._block_type){case"ActionableAttachment":{let n={updateNotification:e.updateNotificationCallback,hideNotification:f,followLinkIfPossible:e.followLinkOnClickCallback,buildNotificationActionRequest:p};return a.createElement(eT,{attachment:t,notification:i,actionBlockCallbacks:n})}case"ClientActionableAttachment":return a.createElement(eR,{attachment:t,notification:i});case"BodyAndThumbnailAttachment":case"BodyAttachment":return a.createElement(eh,{attachment:t,notification:i,dontShowPlanIcon:e.dontShowPlanIcon})}}catch(e){console.error(`Unable to render attachment: ${t}`),f()}})(t,E))||null}(e=>{(e=>{(e.Block||(e.Block={})).ATTACHMENT_TYPES=new Set(["BodyAndThumbnailAttachment","ActionableAttachment","ClientActionableAttachment","BodyAttachment"])})(e.BlockKit||(e.BlockKit={}))})(n||(n={}));var eP=i(241809),eS=i(248521),eU=i(966712),eM=i(860601),eB=i(572206),eL=i(899422),eF=i(273709);let eH=class e{constructor(){this.circularBuffer=new eP.C(e.BUFFER_CAPACITY),this.lastTimestamp=0}clear(){this.circularBuffer.clear()}push(t,i){i-this.lastTimestamp>e.THROTTLE_DURATION_MS&&(this.circularBuffer.push(t),this.lastTimestamp=i)}getLocation50msAgo(){let e=this.circularBuffer.toArray();return e.length>0?e[0]:new eB.Mi(window.innerWidth,window.innerHeight)}};function eQ(e){let[t,i]=(0,a.useState)(null),[n,r]=(0,a.useState)(0),o=(0,g.q5)(),l=a.useRef(eM.lQ),c=a.useRef(eM.lQ),s=a.useRef(null),_=a.useRef(null),u=(0,C.ro)(),d=(0,C.Ut)()&&(0,eF.zr)(o,t),E=a.useRef({notificationId:"",mouseLocationHistory:new eH,scheduledShowQuickReply:void 0,scheduledMarkAsRead:void 0});(0,a.useEffect)(()=>{_.current&&_.current.addEventListener("mouseover",e=>{clearTimeout(E.current?.scheduledShowQuickReply)})},[t]);let m=()=>{clearTimeout(E.current?.scheduledMarkAsRead),E.current.scheduledMarkAsRead=setTimeout(()=>{c.current=l.current},1e3)},f=a.useMemo(()=>{function e(e,t,n){let a=window.innerWidth>900&&window.innerHeight>650;E.current.notificationId=e.notification_id,a&&(0,eF.UC)(e)?(i((0,eF.AS)(e)),r(t),l.current=n):(i(null),l.current=eM.lQ),E.current.mouseLocationHistory.clear()}return{shouldShowChevron:()=>!1,onClick:e=>!1,onMouseEnter:(t,i,n)=>{let r=!1;if(i.notification_id!==E.current.notificationId&&_.current){let e=_.current.getBoundingClientRect(),i=new eB.Mi(e.left,e.top),n=new eB.Mi(e.left,e.bottom),a=[E.current.mouseLocationHistory.getLocation50msAgo(),i,n];r=(0,eS.y)(new eB.Mi(t.clientX,t.clientY),a)}let a=t.target;if(r){var o;o=()=>{e(i,a.getBoundingClientRect().bottom,n)},clearTimeout(E.current?.scheduledShowQuickReply),E.current&&(E.current.scheduledShowQuickReply=setTimeout(o,500))}else clearTimeout(E.current?.scheduledShowQuickReply),e(i,a.getBoundingClientRect().bottom,n)},onMouseMove:e=>{E.current.mouseLocationHistory.push(new eB.Mi(e.clientX,e.clientY),e.timeStamp)},onRemove:e=>{e.notification_id===E.current.notificationId&&i(null)}}},[_]);if(!((0,eU.kc)().desktop_quickreply_filebrowser&&u))return a.createElement(a.Fragment,null,e.children);let p=Math.max(0,n-(s.current?.getBoundingClientRect().y??0)-(_.current?.getBoundingClientRect().height??640));return a.createElement(a.Fragment,null,a.createElement("div",{className:"quick_reply_switcher--hoverContainer--eL8mU",ref:s},t&&!d&&a.createElement("div",{className:"quick_reply_switcher--quickReplyContainer--7Qpx8",style:{top:p,maxHeight:640,minHeight:450},onMouseEnter:()=>{m()},onMouseLeave:()=>{clearTimeout(E.current?.scheduledMarkAsRead),c.current(),c.current=eM.lQ,l.current=eM.lQ}},a.createElement(eL.d,{quickReplyInfo:t,onClose:()=>i(null),fileBrowser:!0,ref:_}))),a.createElement($.H.Provider,{value:f},e.children))}eH.BUFFER_CAPACITY=10,eH.DESIRED_DURATION_MS=50,eH.THROTTLE_DURATION_MS=eH.DESIRED_DURATION_MS/eH.BUFFER_CAPACITY;let eV="user_notifications_dropdown--filterToggleButton--ekpSd",eq="user_notifications_dropdown--filterToggleButtonSelected--qrMA-",ex="user_notifications_dropdown--dateHeader---l8oH",eG="user_notifications_dropdown--link--BC2j9 text--fontPos11--2LvXf text--_fontBase--QdLsd";function eY(e,t){let i=(0,o.wA)(),n=(0,o.d4)(e=>e.user.id),r=(0,o.d4)(e=>e.user.community_profile_id),l=(0,o.d4)(e=>e.authedUsers.byId[n]?.plans),c=a.useMemo(()=>void 0!==l&&(new Map(l.map(e=>[e.plan_id,e.is_org])).get(t)||!1),[l,t]),u=(0,o.d4)(e=>e.userNotifications.userBellStates),d=(0,o.d4)(e=>e.userNotifications.communityProfileBellStates),m=(0,o.d4)(e=>e.selectedView.view),h=(0,f.md)(P.gG),[R,T]=(0,a.useState)(new Map),[w,b]=(0,a.useState)(!0),[A,g]=(0,a.useState)(!1),y=(0,C.Ow)(),v=(0,C.Ut)(),D=(0,E.F)(d),O=(0,E.F)(u),U=(0,E.F)(h);a.useEffect(()=>{let a=(0,s.s)(()=>{if(e)r&&(D.current[r]&&i((0,P.X2)({isBellStateHigh:!1,userInitiated:!0,profileId:r})),S.sr.getCommunityServerDriven({currentView:m}).then(({data:e})=>{M(e.meta)}).catch(e=>{i(N.F.enqueue({message:(0,k.t)("user_notification.an_error_occurred_while_fetching_your_community_notifications"),type:"user-notification",error:!0})),i(I.oB())}));else{if(v?U.current.isHigh:O.current?.[n]?.[P.td]){let e={isBellStateHigh:!1,fileKeyWithoutBadge:null,userInitiated:!0,notificationSpaceId:P.td,userId:n};i((0,P.Zo)(e))}S.sr.getServerDrivenPlan({currentPlanId:t,currentView:m,isPlanOrg:c}).then(({data:e})=>{M(e.meta)}).catch(e=>{i(N.F.enqueue({message:(0,k.t)("user_notification.an_error_occurred_while_fetching_your_notifications"),type:"user-notification",error:!0})),i(I.oB())})}},800,!0);b(!0),a()},[t,D,m,i,e,v,O,U,c,r,n]);let M=e=>{let t=new Map,i=!1;e.forEach(e=>{t.set(e.notification_id,e),!i&&e.filters.is_priority&&(i=!0)}),g(i),T(t),b(!1)},B=a.useMemo(()=>{if(y){let e=(0,P.Dd)();return w||A||"priority"!==e||((0,P.hI)("all"),e="all"),e}return"all"},[A,y,w]);return{notificationFeedMap:R,isFetchingNotifications:w,initFilter:B,markAllAsReadFn:()=>{(e?p.Ay.post("/api/user_notifications/community/mark_read",{currentView:m,source:_.S8?"desktopbell":"web"}):p.Ay.post("/api/user_notifications/mark_read/plan",{current_plan_id:t,currentView:m,is_plan_org:c,source:_.S8?"desktopbell":"web"})).then(()=>{T(new Map(Array.from(R,([e,t])=>(t.is_unread=!1,[e,t]))))}).catch(()=>{i(N.F.enqueue({message:(0,k.t)("user_notification.an_error_occurred_marking_all_as_read"),type:"user-notification",error:!0}))})},updateNotification:(e,t)=>{T(new Map(R.set(e,t)))}}}function e$(e,t){return e.filter(e=>!t.includes(e.notification_id))}function eW(e){let t;let[i,n]=(0,a.useState)(P.td),{notificationFeedMap:o,isFetchingNotifications:l,markAllAsReadFn:s,updateNotification:_,initFilter:u}=eY(!!e.inCommunity,i),[d,E]=(0,a.useState)([]),[f,p]=(0,a.useState)(u),h=(0,m.ZC)(f),R=(0,C.ro)(),T=i===P.td?U.a:i,k=e$([...o.values()],d);a.useEffect(()=>{p(u)},[u]),a.useEffect(()=>{let e=(0,P.Dd)();f!==h&&f===e&&(0,b.qD)({name:"user_notifications_filter_viewed",filter_type:f,dropdown_location:"web"})},[h,f]);let N=e=>{e.stopPropagation()},I=e=>{e===U.a&&(e=P.td),(0,b.FE)(e,"notifications",void 0),n(e)};switch(f){case"unread":t=k.filter(e=>e.is_unread);break;case"priority":t=k.filter(e=>e.filters.is_priority);break;default:t=k}return a.createElement("div",{className:c()(0!==o.size||l?"user_notifications_dropdown--dropdownContainer--ON3UV text--fontPos11--2LvXf text--_fontBase--QdLsd":"user_notifications_dropdown--dropdownContainerEmptyState--7D3ct user_notifications_dropdown--dropdownContainer--ON3UV text--fontPos11--2LvXf text--_fontBase--QdLsd",e.containerClassName,{"user_notifications_dropdown--arrowRight--g36M8":e.arrowRight}),onMouseDown:N,onClick:N},a.createElement(eQ,null,a.createElement(r.Header,{selectedPlan:i,onPlanFilterUpdate:e=>I(e),inCommunity:!!e.inCommunity,showMarkAllAsRead:eK(l,k)&&!R,markAllAsReadFn:s,inDesktopTray:!1}),!!R&&a.createElement(r.FilterToggle,{notificationFilter:f,toggleNotificationFilter:e=>{(0,b.Cu)({filter_type:e},"user_notifications_filter_clicked"),(0,P.hI)(e),p(e)},isFetchingNotifications:l,notifications:k,markAllAsReadFn:s}),a.createElement(r.Feed,{notifications:t,currentPlanFilter:T,currentNotificationFilter:f,hiddenNotificationIds:d,setHiddenNotificationIds:E,isFetchingNotifications:l,inCommunity:e.inCommunity,fillParent:!1,updateNotificationCallback:_})))}function eK(e,t){return!e&&t.some(e=>e.is_unread)}(e=>{function t(e){return(0,C.ro)()?a.createElement("div",{className:ex},eC[e.notificationDateGroup]):null}function i(e){return(0,C.Ow)()?a.createElement("div",{className:ex},eg[e.notificationPriorityGroup]):null}e.Feed=function(e){let n=(0,D.Pc)(),r=(0,o.d4)(e=>n?e.authedUsers.byId[n.id]?.plans:null),l=(0,o.Pj)(),c=(0,o.wA)(),s=(0,v.FC)(),E=(0,g.q5)(),m=(0,y.sZ)(),f=t=>{e.setHiddenNotificationIds([...e.hiddenNotificationIds,t])},p=!1;if(n&&!e.inCommunity&&r?.length===1&&(p=!0,e.currentPlanFilter===U.a)){let t=r[0].plan_id;for(let i of e.notifications)if(i.plan?.id.toString()!==t){p=!1;break}}let h=a.useCallback(t=>()=>{var i,n;if(!t.deeplink)return;let r=new URL(t.deeplink.href),a=r.pathname;if(a.includes("project"))i=a.split("project/")[1],(0,b.xr)("file_browser_folder_click",i,null,s,{selectedView:"notifications",planFilterId:e.currentPlanFilter===U.a?null:e.currentPlanFilter});else if(a.includes("team"))n=a.split("team/")[1],(0,b._J)("file_browser_team_click",n,s,{selectedView:"notifications",planFilterId:e.currentPlanFilter===U.a?null:e.currentPlanFilter});else if((0,u.ek)(a)){let t=(0,u.zv)(a);t&&c(w.UN({fileKey:t,entrypoint:"notifications",currentPlanFilter:{planId:e.currentPlanFilter===U.a?void 0:e.currentPlanFilter||void 0}}))}c(I.oB());let o=!!E&&E.key===(0,u.zv)(r.pathname);if(!_.eD&&o)c((0,A.H)({params:r.searchParams.toString(),hash:r.hash}));else if(t.deeplink.use_unsafe)d.Ay.unsafeRedirect(r.href,_.eD?void 0:"_blank");else if(e.inDesktopTray)d.Ay.redirect(r.href);else try{let e=(0,O.vU)(l.getState(),a);if("teamFeed"===e.view){m&&t.plan?.id.toString()===m.id?c(I.$T(e)):d.Ay.redirect(r.href,_.eD?void 0:"_blank");return}d.Ay.redirect(r.href,_.eD?void 0:"_blank");return}catch{d.Ay.redirect(r.href,_.eD?void 0:"_blank")}},[c,E,e.currentPlanFilter,e.inDesktopTray,s,l,m]);if(e.isFetchingNotifications)return a.createElement("div",{className:"user_notifications_dropdown--loadingContainer--jY9PZ"},a.createElement(R.kt,null));if(0===e.notifications.length)return a.createElement("div",{className:"user_notifications_dropdown--emptyRow--4UwYl"},(0,k.tx)("user_notifications.dropdown.no_notifications"));{var N;let n,r;"priority"===e.currentNotificationFilter&&e.notifications.sort((e,t)=>Number(eb(t))-Number(eb(e)));let o=e.inCommunity?"user_notifications_dropdown--scrollContainer--phbbl":"user_notifications_dropdown--scrollContainerWithPlan---Z4H1",l=eN((N=e.notifications)[0].preferred_attachments[0].body.created_at,N[0].filters.user_last_viewed_timestamp)===eN(N[N.length-1].preferred_attachments[0].body.created_at,N[0].filters.user_last_viewed_timestamp),c=e=>{let i;let r=null;if(!l)try{i=eD(e);let o=eN(i.body.created_at,e.filters.user_last_viewed_timestamp);o!==n&&(n=o,r=a.createElement(t,{key:`date-${e.notification_id}`,notificationDateGroup:o}))}catch(e){console.error("Skipping date header, unsupported notification")}return r},s=e=>{let t=null,n=eb(e)?"actionable":"actioned";return n!==r&&(r=n,t=a.createElement(i,{key:`priority-${e.notification_id}`,notificationPriorityGroup:n})),t};return a.createElement(T.P,{className:`${e.fillParent?"":o}`},a.createElement("div",null,e.notifications.map(t=>{let i=null;return i="priority"===e.currentNotificationFilter?s(t):c(t),a.createElement(a.Fragment,{key:`row-container-${t.notification_id}`},i,a.createElement(eO,{key:`row-${t.notification_id}`,notification:t,updateNotificationCallback:e.updateNotificationCallback,dontShowPlanIcon:p,currentPlanFilter:e.currentPlanFilter,currentNotificationFilter:e.currentNotificationFilter,inDesktopTray:e.inDesktopTray,onHide:()=>f(t.notification_id),followLinkOnClickCallback:h(t)}))})))}},e.UnreadBar=function(e){return eK(e.isFetchingNotifications,e.notifications)?a.createElement("div",{className:"user_notifications_dropdown--unreadToggleBar---1U5q"},function(e){let t=e.reduce((e,t)=>e+Number(t.is_unread),0);return a.createElement("div",{className:"user_notifications_dropdown--unread--e14XU"},(0,k.t)("user_notifications.unread_count",{unreadCount:t}))}(e.notifications),eK(e.isFetchingNotifications,e.notifications)&&a.createElement(h.N_,{onClick:e.markAllAsReadFn,className:eG,trusted:!0},(0,k.tx)("user_notifications.dropdown.mark_all_as_read"))):null},e.DateHeader=t,e.PriorityHeader=i,e.Header=function(e){let t=(0,C.Ut)()&&!e.inDesktopTray;return a.createElement("div",{className:"user_notifications_dropdown--header--aOhWS"},e.inCommunity?a.createElement("div",{className:"user_notifications_dropdown--orgName--vbTxV ellipsis--ellipsis--Tjyfa text--fontPos11--2LvXf text--_fontBase--QdLsd"},(0,k.t)("user_notification.community_notifications")):a.createElement(a.Fragment,null,a.createElement(U.j,{currentPlanFilter:e.selectedPlan===P.td?U.a:e.selectedPlan,onPlanFilterUpdate:e.onPlanFilterUpdate,displaySettings:t})),e.children,e.showMarkAllAsRead&&a.createElement(h.N_,{onClick:e.markAllAsReadFn,className:eG,trusted:!0},(0,k.tx)("user_notifications.dropdown.mark_all_as_read")))},e.FilterToggle=function(e){let t=(0,C.Ow)(),i=e.notifications.some(e=>e.filters.is_priority);return e.isFetchingNotifications?null:a.createElement("div",{className:"user_notifications_dropdown--filterToggleBar--VhBmn user_notifications_dropdown--unreadToggleBar---1U5q"},a.createElement("div",{className:"user_notifications_dropdown--filterToggleButtons--Erg5A"},a.createElement("button",{className:c()({[eV]:!0,[eq]:"all"===e.notificationFilter}),onClick:()=>{e.toggleNotificationFilter("all")}},(0,k.t)("user_notification.all")),!!t&&i&&a.createElement("button",{className:c()({[eV]:!0,[eq]:"priority"===e.notificationFilter}),onClick:()=>{e.toggleNotificationFilter("priority")}},function(e){let t=e.reduce((e,t)=>e+Number(eb(t)),0);return 0===t?(0,k.t)("user_notifications.requests_empty"):(0,k.t)("user_notifications.requests_toggle_count",{actionableCount:t})}(e.notifications)),a.createElement("button",{className:c()({[eV]:!0,[eq]:"unread"===e.notificationFilter}),onClick:()=>{e.toggleNotificationFilter("unread")}},function(e){let t=e.reduce((e,t)=>e+Number(t.is_unread),0);return 0===t?(0,k.t)("user_notifications.unread_empty"):(0,k.t)("user_notifications.unread_toggle_count",{unreadCount:t})}(e.notifications))),eK(e.isFetchingNotifications,e.notifications)&&a.createElement(h.N_,{onClick:e.markAllAsReadFn,className:eG,trusted:!0},(0,k.tx)("user_notifications.dropdown.mark_all_as_read")))}})(r||(r={}))},299211:(e,t,i)=>{i.d(t,{w:()=>c});var n=i(411855),r=i(915440),a=i(711525),o=i(279453),l=i(395116);function c(e){let t=(0,r.Rs)(o.JgS,{});n.useEffect(()=>{if("loaded"===t.status&&t.data.persistentUserNotificationBells.status===a.tT.Loaded&&t.data.persistentUserNotificationBells.data)for(let i of(0,a.oA)(t.data.persistentUserNotificationBells)||[]){let t={isBellStateHigh:!!i.bell,fileKeyWithoutBadge:i.fileKeyWithoutBadge,userInitiated:!1,notificationSpaceId:i.notificationSpaceId||l.td,userId:i.userId};e((0,l.Zo)(t))}},[t,e])}},612430:(e,t,i)=>{i.d(t,{a:()=>C,j:()=>b});var n=i(411855),r=i(109388),a=i(188507),o=i(343887),l=i(182550),c=i(268537),s=i(163023),_=i(939863),u=i(738269),d=i(662275),E=i(988022),m=i(335682),f=i(860178),p=i(395116),h=i(498606),R=i(298543),T=i(284028);let k="notifs_plan_filter--boldTitle--ZUcpT",N="notifs_plan_filter--autoTruncate--gl9us ellipsis--ellipsis--Tjyfa";var I=i(783423),w=i(533600);let C="ALL_PLANS_FILTER";function b(e){let{currentPlanFilter:t,onPlanFilterUpdate:i}=e,[b,A]=n.useState(!1),g=(0,a.wA)(),y=(0,m.q5)(),v=(0,n.useRef)(null),D=(0,n.useRef)(null),O=(0,f.iZ)(),P=(0,a.d4)(e=>O?e.authedUsers.byId[O.id]?.plans:null);if(!O||!P||P.length<=1)return n.createElement("span",{className:k},(0,_.t)("user_notification.all_notifications"));let S=P.map(e=>e.plan_id);S.unshift(C);let U=(e,t)=>e===C?(0,_.t)("user_notification.all_notifications"):t[e],M=P.reduce((e,t)=>(e[t.plan_id]=t.name,e),{}),B=(e,t)=>{e.stopPropagation(),i(t),A(!1)},L=S.map(e=>n.createElement(c.c$,{key:e,onClick:t=>{B(t,e)}},e===t&&n.createElement(s.B,{svg:w.A}),n.createElement("span",{className:`${e===t?"notifs_plan_filter--planNameChecked--dbvr9":"notifs_plan_filter--planNameUnchecked--J40CF"} ${N}`},U(e,M))));return n.createElement("div",{className:"notifs_plan_filter--planFilterContainer--E2TSh",ref:v},n.createElement("div",null,n.createElement("button",{ref:D,onClick:()=>{A(!b)},className:"notifs_plan_filter--dropdownButton--hQgHc"},n.createElement("span",{className:[k,N].join(" ")},(0,p.gN)(U(t,M),35)),n.createElement(s.B,{svg:I.A,className:"notifs_plan_filter--chevronIcon--0Rqnp"})),D.current&&b&&n.createElement(R.Cf,{targetRect:r.findDOMNode(D.current)?.getBoundingClientRect(),type:R.it.DEFAULT,lean:"right",minWidth:120,disableDropdownScrollContainer:!0,closeDropdown:()=>A(!1)},L)),e.displaySettings&&n.createElement(o.K,{"aria-label":(0,_.t)("user_notifications.settings"),htmlAttributes:{"data-dropdown-tooltip":(0,_.t)("user_notifications.settings"),"data-tooltip-type":h.Ib.TEXT,"data-tooltip-show-above":!0},onClick:()=>{g(u.oB()),(0,E.Cu)({userId:O?.id,fileKey:y?.key,eventName:"Notification Settings Button Clicked"}),g(d.to({type:T.s,data:{tab:T.c.NOTIFICATIONS}}))}},n.createElement(l.I,null)))}},682301:(e,t,i)=>{i.d(t,{V:()=>r});var n=i(411855);function r(e){return n.createElement("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e},n.createElement("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M17 16.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 0-1h-2A1.5 1.5 0 0 0 6 7.5v9A1.5 1.5 0 0 0 7.5 18h9a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0zm-5-10a.5.5 0 0 0 .5.5h3.793l-4.147 4.146a.5.5 0 0 0 .708.708L17 7.707V11.5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0-.5.5",clipRule:"evenodd"}))}}}]);

//# debugId=35e9816e-7b4f-53f3-9416-8230695d0e76

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/24183f2d31cd1ff9e03457f87583e6d5aee5e795/4421-40735ba97e272789.min.js.map